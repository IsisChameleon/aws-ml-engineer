// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/python
{
	"name": "Python 3",
	// Or use a Dockerfile or Docker Compose file. More info: https://containers.dev/guide/dockerfile
	"image": "mcr.microsoft.com/devcontainers/python:1-3.11-bullseye",
	// bind the dataset local folder
	"mounts": [
		"source=f:\\Data\\Datasets\\twitter-chatgpt,target=/workspaces/data,type=bind"
	],
	"features": {
		"ghcr.io/devcontainers/features/aws-cli:1": {},
		"ghcr.io/devcontainers-contrib/features/aws-cdk:2": {},
		"ghcr.io/tomharvey/devcontainer-features/aws-sso-util:1": {}
	},

	// Add environment variables for your developer environment:
	"containerEnv": {
		// The below needs to be configured to match your AWS SSO configuration if you're using AWS SSO.
		// You could opt to use static AWS IAM Keys instead.
		// If you do use static IAM keys, see further below for sharing `/.aws`
		// between your local machine and your development environment.
		"AWS_DEFAULT_SSO_START_URL": "https://d-9767492cea.awsapps.com/start",
		"AWS_DEFAULT_SSO_REGION": "ap-southeast-2",

		// This configures the region that you will create AWS resources in by default.
		// It's common to pick one closer to you - I think it's unnessecary and us-east-1
		// is the msot feature complete, the lowest cost and so is a good default.
		"AWS_DEFAULT_REGION": "ap-southeast-2"

		// You can add more environment variables here if you need to.
		// For example, you might want to add environment variables for your application
		// like "FLASK_ENV": "development" or "DJANGO_SETTINGS_MODULE": "myapp.settings"
	},

	// Configure tool-specific properties.
	// "customizations": {},
	// # The opinionated settings for the development environment.
	// The below are the settings for the VS Code development environment,
	// and how they will treat your code. You can delete all of this if you want to.
	// BUt, they are sensible python defaults.
	// You can add more settings here and should get to know them.
	// These can be very specific to you - tabs vs spaces, line length, etc.
	"customizations": {
		"vscode": {
			// Extensions are the plugins that you can install in VS Code.
			// These add some great features to your development environment.
			"extensions": [
				"ms-python.python",
				"ms-python.vscode-pylance",
				"charliermarsh.ruff",
				"ms-python.black-formatter",
				"github.vscode-pull-request-github",
				"eamodio.gitlens",
				"amazonwebservices.aws-toolkit-vscode",
				"davidanson.vscode-markdownlint",
				"TabNine.tabnine-vscode",
				"ms-toolsai.jupyter"
			],
			"settings": {
				"[python]": {
					// Here we state that we want Ruff to automatically format our code on save.
					// You might hate this - you can delete it.
					// Otherwise, it's a great way to enforce sensible and consistent
					// formatting on your code.
					"editor.codeActionsOnSave": {
						"source.organizeImports": "always",
						"source.fixAll": "explicit"
					},
					"editor.formatOnSave": true,
					"editor.defaultFormatter": "TabNine.tabnine-vscode"
				},
				"python.defaultInterpreterPath": "/home/vscode/.local/lib/python3.11"
			}
		}
	},

	// Features to add to the dev container. More info: https://containers.dev/features.
	// "features": {},

	// Use 'forwardPorts' to make a list of ports inside the container available locally.
	// "forwardPorts": [],

	// Use 'postCreateCommand' to run commands after the container is created.
	// "postCreateCommand": "pip3 install --user -r requirements.txt",

	//"postCreateCommand": "pip install --user --no-cache-dir -r requirements.txt"
	"postCreateCommand": [
        "apt update",
        "apt install -y default-jdk",
        "pip install --no-cache-dir -r requirements.txt",
        "npm install -g aws-cdk"
    ]

	// Uncomment to connect as root instead. More info: https://aka.ms/dev-containers-non-root.
	// "remoteUser": "root"
}
